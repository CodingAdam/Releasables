on_actions = {
	on_new_term_election = {
		random_events = {
			100 = mexico.18 # 1940 Mexican election
		}
	}
	
	#Root is exile
	#From is new host
	#FromFrom is old host
	on_host_changed_from_capitulation = {
		effect = {
			#Transfer exile leaders to new host
			From.From = {
				every_army_leader = {
					limit = { is_exiled_leader_from = Root }
					set_nationality = Root.From
				}
			}
		}
	}

	#Root is exile
	#From is old host
	on_exile_government_reinstated = {
		effect = {
			From = {
				every_army_leader = {
					limit = { is_exiled_leader_from = Root }
					set_nationality = Root
				}
			}
			Root = {
				every_army_leader = {
					limit = { is_exiled_leader_from = Root }
					remove_unit_leader_trait = exiled_leader
					remove_exile_tag = yes
				}
			}
		}
	}

	on_unit_leader_created = {
		effect = {
			if = {
				limit = { is_exiled_leader = yes }
				From.From = { save_event_target_as = exile_nation }
				add_unit_leader_trait = exiled_leader
				
				add_random_trait = {
					old_guard
					brilliant_strategist
					inflexible_strategist
					war_hero
					trait_cautious
					trait_reckless
					media_personality
					harsh_leader
					infantry_officer
					cavalry_officer
					armor_officer
				}

				add_random_trait = {
					organizer
					panzer_leader
					cavalry_leader
					trait_engineer
					infantry_leader
					naval_invader						
					commando
					skilled_staffer
					trickster					
				}

				unit_leader_event = { id = mtg_exile_leader_added.1 }
			}
		}
	}

	#ROOT is winner #FROM gets annexed - This will also fire on_annex
	on_civil_war_end = {
		effect = {
			#End of British Fascist Civil War
			if = {
				limit = {
					original_tag = ENG
					has_government = fascism
					has_completed_focus = ENG_organize_the_blackshirts
				}
				set_country_flag = { flag = won_british_civil_war value = 1 days = 365 }
				country_event = { id = mtg_britain.34 }
			}
			#End of British Fascist Civil War - Democrats won
			if = {
				limit = {
					original_tag = ENG
					has_government = democratic
					FROM = {
						has_government = fascism
						has_completed_focus = ENG_organize_the_blackshirts
					}
				}
				delete_unit_template_and_units = { division_template = "Loyalist Brigade" }
				load_focus_tree = { tree = british_focus keep_completed = no }
				unlock_national_focus = ENG_steady_as_she_goes
				unlock_national_focus = limited_rearmament_focus
				unlock_national_focus = shadow_scheme_focus
				unlock_national_focus = uk_industrial_focus
				unlock_national_focus = royal_ordnance_factories
				if = {
					limit = {
						amount_research_slots > 4
					}
					unlock_national_focus = uk_extra_tech_slot
				}
			}
			# Give back ENG focus tree to Communist ENG if they win a civil war.
			if = {
				limit = {
					original_tag = ENG
					has_government = communism
					has_focus_tree = generic_focus
					FROM = {
						original_tag = ENG
						has_government = communism
					}
				}
				load_focus_tree = { tree = british_focus keep_completed = yes }
			}
			# Give back MEX focus tree to rebel MEX if they win a civil war.
			if = {
				limit = {
					has_dlc = "Man the Guns"
					original_tag = MEX
					has_focus_tree = generic_focus
					FROM = {
						original_tag = MEX
					}
				}
				load_focus_tree = { tree = mexico_focus_tree keep_completed = yes }
			}
			# Give back USA focus tree to CSA if they win a civil war.
			if = {
				limit = {
					original_tag = USA
					has_government = democratic
					FROM = {
						original_tag = USA
						OR = {
							has_government = neutrality
							has_government = fascism
						}
					}
				}
				drop_cosmetic_tag = yes # we are done here
				set_country_flag = democratic_usa_won_civil_war
			}
			#End of British Communist Civil War
			if = {
				limit = {
					original_tag = ENG
					has_government = democratic
					has_completed_focus = ENG_concessions_to_the_trade_unions
				}
				country_event = { id = mtg_britain.56 }
			}
			#End of Imperialist Loyalist civil war
			if = {
				limit = {
					OR = {
						original_tag = CAN
						original_tag = SAF
						original_tag = AST
						original_tag = NZL
					}
					has_government = neutrality
					ENG = { has_completed_focus = ENG_appeal_to_imperial_loyalists }
					NOT = { is_subject_of = ENG }
				}
				ENG = { country_event = { id = mtg_britain.113 hours = 6 } }
			}
			if = {
				limit = {
					has_template = "Silver Legion"
				}
				delete_unit_template_and_units = { division_template = "Silver Legion" }
			}
			# Cleaning up anti-exploiter divisions
			delete_unit_template_and_units = { division_template = "Anti-Exploit Punitive Brigade" }
		}
	}

	#ROOT is winner #FROM gets annexed - This fires just before FROM gets annexed, meaning the country and everything it owns still exists. It will also fire on_annex and on_civil_war_end
	on_civil_war_end_before_annexation = {
		effect = {
			#End of British Fascist Civil War - moving the fleet back to the Fascists because they won
			if = {
				limit = {
					original_tag = ENG
					has_government = fascism
					has_completed_focus = ENG_organize_the_blackshirts
				}
				random_other_country = {
					limit = {
						original_tag = ENG
						has_government = democratic
					}
					transfer_navy = { target = ENG }
					every_unit_leader = {
						limit = {
							OR = {
								has_id = 983
								has_id = 984
								has_id = 985
								has_id = 986
								has_id = 987
								has_id = 988
								has_id = 989
								has_id = 990
								has_id = 991
								has_id = 992
							}
						}
						set_nationality = ENG
					}
				}
			}
		}
	}

	#FROM is war target
	on_declare_war = {
		effect = {
			# In case of HOL being declared war on and still having Shell-shocked Spectator of the Great War, remove the spirit
			if = {
				limit = {
					FROM = {
						original_tag = HOL
						OR = {
							has_idea = HOL_shell_shocked_spectator_1
							has_idea = HOL_shell_shocked_spectator_2
							has_idea = HOL_shell_shocked_spectator_3
							has_idea = HOL_shell_shocked_spectator_4
							has_idea = HOL_shell_shocked_spectator_5
						}
					}
				}
				FROM = {
					hidden_effect = {
						remove_ideas = HOL_shell_shocked_spectator_1
						remove_ideas = HOL_shell_shocked_spectator_2
						remove_ideas = HOL_shell_shocked_spectator_3
						remove_ideas = HOL_shell_shocked_spectator_4
						remove_ideas = HOL_shell_shocked_spectator_5
					}
				}
			}
			# In case of HOL being declared war on and still having Aloof Neutrality, remove the spirit
			if = {
				limit = {
					FROM = {
						original_tag = HOL
						has_idea = HOL_aloof_neutrality
					}
				}
				FROM = {
					hidden_effect = {
						remove_ideas = HOL_aloof_neutrality
					}
				}
			}
			# In case of HOL being declared war on and having taken the "Share intelligence" decision, they get a temporary buff to defense and attack
			if = {
				limit = {
					tag = FRA
					NOT = { is_in_faction_with = ENG }
					FROM = { has_country_flag = secret_staff_talks_british_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_eng_fra days = 180 } }
				}
			}
			if = {
				limit = {
					tag = GER
					NOT = { is_in_faction_with = ENG }
					FROM = { has_country_flag = secret_staff_talks_british_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_eng_ger days = 180 } }
				}
			}
			if = {
				limit = {
					tag = ENG
					NOT = { is_in_faction_with = FRA }
					FROM = { has_country_flag = secret_staff_talks_french_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_fra_eng days = 180 } }
				}
			}
			if = {
				limit = {
					tag = GER
					NOT = { is_in_faction_with = FRA }
					FROM = { has_country_flag = secret_staff_talks_french_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_fra_ger days = 180 } }
				}
			}
			if = {
				limit = {
					tag = FRA
					NOT = { is_in_faction_with = GER }
					FROM = { has_country_flag = secret_staff_talks_german_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_ger_fra days = 180 } }
				}
			}
			if = {
				limit = {
					tag = ENG
					NOT = { is_in_faction_with = GER }
					FROM = { has_country_flag = secret_staff_talks_german_intelligence }
				}
				hidden_effect = {
					FROM = { add_timed_idea = { idea = HOL_shared_intelligence_ger_eng days = 180 } }
				}
			}
			# In case of GER/ENG/FRA going to war they get a minor buff if they shared intelligence
			if = {
				limit = {
					tag = FRA
					NOT = { is_in_faction_with = HOL }
					FROM = { has_country_flag = secret_staff_talks_dutch_intelligence }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_shared_intelligence_hol_fra days = 180 } } }
			}
			if = {
				limit = {
					FROM = { tag = FRA }
					FROM = { NOT = { is_in_faction_with = HOL } }
					has_country_flag = secret_staff_talks_french_intelligence
				}
				hidden_effect = { add_timed_idea = { idea = HOL_shared_intelligence_hol_fra days = 180 } }
			}
			if = {
				limit = {
					tag = ENG
					NOT = { is_in_faction_with = HOL }
					FROM = { has_country_flag = secret_staff_talks_dutch_intelligence }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_shared_intelligence_hol_eng days = 180 } } }
			}
			if = {
				limit = {
					FROM = { tag = ENG }
					FROM = { NOT = { is_in_faction_with = HOL } }
					has_country_flag = secret_staff_talks_french_intelligence
				}
				hidden_effect = { add_timed_idea = { idea = HOL_shared_intelligence_hol_eng days = 180 } }
			}
			if = {
				limit = {
					tag = GER
					NOT = { is_in_faction_with = HOL }
					FROM = { has_country_flag = secret_staff_talks_dutch_intelligence }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_shared_intelligence_hol_ger days = 180 } } }
			}
			if = {
				limit = {
					FROM = { tag = GER }
					FROM = { NOT = { is_in_faction_with = HOL } }
					has_country_flag = secret_staff_talks_french_intelligence
				}
				hidden_effect = { add_timed_idea = { idea = HOL_shared_intelligence_hol_ger days = 180 } }
			}
			# In case of HOL being declared war on and having taken the "draw up shared staff plan" decision, they get a temporary buff to core defense and max entrenchment
			if = {
				limit = {
					OR = {
						tag = FRA
						tag = GER
					}
					NOT = { is_in_faction_with = ENG }
					FROM = { has_country_flag = secret_staff_talks_british_staff_plan }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_staff_plan_eng days = 180 } } }
			}
			if = {
				limit = {
					OR = {
						tag = ENG
						tag = GER
					}
					NOT = { is_in_faction_with = FRA }
					FROM = { has_country_flag = secret_staff_talks_french_staff_plan }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_staff_plan_fra days = 180 } } }
			}
			if = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
					}
					NOT = { is_in_faction_with = GER }
					FROM = { has_country_flag = secret_staff_talks_german_staff_plan }
				}
				hidden_effect = { FROM = { add_timed_idea = { idea = HOL_staff_plan_ger days = 180 } } }
			}
			# In case of Turkish civil war with field marshal Ataturk out on the field
			if = { 
        	    limit = { 
        	        original_tag = TUR
        	        has_civil_war = yes
        	        FROM = {
        	            original_tag = TUR
        	            has_civil_war = yes
        	        }
        	    }
        	    hidden_effect = { 
        	        if = { 
        	            limit = {
        	            	FROM = { has_government = neutrality } 
        	            }
        	            every_unit_leader = {
        	                limit = { 
        	                    has_id = 59
        	                }
        	                set_nationality = FROM
        	            }
        	        }
        	    }
        	}
		}
	}	

	on_government_exiled = {
		effect = {
			if = {
				limit = {
					original_tag = HOL
					has_country_flag = HOL_prepared_evacuation_of_gold_reserves_flag
				}
				country_event = { id = mtg_netherlands.63 days = 1 }
			}
		}
	}

	#ROOT = nation being puppeted, FROM = overlord
	on_puppet = {
		effect = {
			if = {
				limit = {
					original_tag = SOV
					has_government = communism
					has_country_leader = { name = "Joseph Stalin" }
					is_puppet_of = MEX
					MEX = {
						OR = {
							has_country_leader = { ruling_only = yes name = "Hernán Laborde" }
							has_country_leader = { ruling_only = yes name = "Leon Trotsky" }
							has_country_leader = { ruling_only = yes name = "Valentín Campa" }
						}
					}
				}
				SOV = { #TODO william check if works as intended or recreate Trotsky independently, also remove Trotsky from Mexico? What about puppet relationship? Look for another Soviet Trotskyist?
					country_event = soviet.28
				}
			}
			if = {
				limit = {
					original_tag = MEX
					has_government = communism
					OR = {
						has_country_leader = { ruling_only = yes name = "Hernán Laborde" }
						has_country_leader = { ruling_only = yes name = "Leon Trotsky" }
						has_country_leader = { ruling_only = yes name = "Valentín Campa" }
					}					
					is_puppet_of = SOV
					MEX = {
						has_country_leader = { name = "Joseph Stalin" } #change to subideology stalinism when supported
					}
				}
				MEX = { 
					create_country_leader = {
						name = "Dionisio Encina"
						desc = "POLITICS_DIONISIO_ENCINA_DESC"
						picture = "GFX_portrait_mex_dionisio_encina"
						expire = "1965.1.1"
						ideology = stalinism
						traits = {
							staunch_stalinist
						}
					}				
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = ENG
						NOT = { has_government = communism }
					}
					has_completed_focus = MEX_focus_nationalize_the_oil_fields
				}
				set_cosmetic_tag = ENG_MEX_dominion
			}	
		}
	}

	on_startup = {
		effect = {
			#Mexican oil concessions
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				MEX = {
					give_resource_rights = { receiver = ENG state = 476 }
					give_resource_rights = { receiver = ENG state = 477 }
					give_resource_rights = { receiver = USA state = 479 }
					give_resource_rights = { receiver = USA state = 480 }
				}
			}
			# Game Rules - Decolonization
			if = {
				limit = {
					has_game_rule = {
						rule = americas_colonization_status
						option = AMERICAS_DECOLONIZED
					}
				}
				ENG = {
					release = BLZ
					release = BAH
					release = GYA
					release = JAM
					release = TRI
					release = BAS
				}
				HOL = {
					release = CRC
					release = SUR
				}
				FRA = {
					release = GDL
					release = CAY
				}
				USA = {
					release = PUE
				}
				PAN = {
					transfer_state = 685
				}
				ENG = {
					set_autonomy = { target = CAN autonomy_state = autonomy_free }
				}
				CAN = {
					drop_cosmetic_tag = yes
					transfer_state = 332
					transfer_state = 331
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = africa_colonization_status
						option = AFRICA_DECOLONIZED
					}
				}
				FRA = {
					release = MOR
					release = ALG
					release = TUN
					release = DJI
					release = MAD
					release = GAB
					release = RCG
					release = CMR
					release = CAR
					release = CHA
					release = DAH
					release = TOG
					release = IVO
					release = VOL
					release = MLI
					release = GNA
					release = SEN
					release = NGR
					release = MRT
				}
				ITA = {
					release = LBA
					release = ERI
					release = SOM
				}
				SOM = {
					transfer_state = 269
				}
				ENG = {
					release = EGY
					release = SUD
					release = UGA
					release = TZN
					release = ZAM
					release = MLW
					release = KEN
					release = ZIM
					release = BOT
					release = NGA
					release = GHA
					release = SIE
					release = GAM
				}
				BEL = {
					release = RWA
					release = BRD
					release = COG
				}
				SAF = {
					release = NMB
				}
				POR = {
					release = MZB
					release = ANG
					release = GNB
				}
				SPR = {
					release = WES
					release = EQG
				}
				ITA = {
					white_peace = {
						tag = ETH
					}
				}
				MOR = {
					transfer_state = 290
					transfer_state = 783
				}
				ENG = {
					set_autonomy = { target = SAF autonomy_state = autonomy_free }
				}
				SAF = {
					retire_country_leader = yes
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = asia_colonization_status
						option = ASIA_DECOLONIZED
					}
				}
				ENG = {
					release = FIJ
					release = MLD
					release = MAL
					release = SRL
					release = QAT
					release = KUW
					release = UAE
					release = PAL
					release = JOR
				}
				RAJ = {
					release = BRM
					release = BAN
					release = PAK
				}
				AST = {
					release = PNG
				}
				ENG = {
					set_autonomy = { target = RAJ autonomy_state = autonomy_free }
					set_autonomy = { target = AST autonomy_state = autonomy_free }
					set_autonomy = { target = NZL autonomy_state = autonomy_free }
					set_autonomy = { target = MAL autonomy_state = autonomy_free }
				}
				MAL = {
					drop_cosmetic_tag = yes
					retire_country_leader = yes
				}
				RAJ = {
					drop_cosmetic_tag = yes
					retire_country_leader = yes
				}
				HOL = {
					set_autonomy = { target = INS autonomy_state = autonomy_free }
				}
				INS = {
					drop_cosmetic_tag = yes
					retire_country_leader = yes
				}
				USA = {
					set_autonomy = { target = PHI autonomy_state = autonomy_free }
				}
				FRA = {
					release = VIN
					release = CAM
					release = LAO
					release = LEB
					release = SYR
				}
				YEM = {
					transfer_state = 659
				}
				RAJ = {
					transfer_state = 321
					transfer_state = 320
				}
				GXC = {
					transfer_state = 728
					transfer_state = 729
					transfer_state = 326
				}
				JAP = {
					set_autonomy = { target = MAN autonomy_state = autonomy_free }
					set_autonomy = { target = MEN autonomy_state = autonomy_free }
					release = KOR
				}
				MAN = {
					transfer_state = 745
				}
				CHI = {
					transfer_state = 609
					transfer_state = 524
				}
			}
			# Game Rules - Fragmentation
			if = {
				limit = {
					has_game_rule = {
						rule = eng_fragmentation_status
						option = ENG_FRAGMENTED
					}
				}
				ENG = {
					release = SCO
					release = WLS
					release = NIR
					release = MLT
					release = CYP
					set_cosmetic_tag = ENG_england
					set_global_flag = ENG_became_england
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = eng_fragmentation_status
						option = ENG_FRAGMENTED_2
					}
				}
				ENG = {
					release = SCO
					release = WLS
					release = NIR
					release = MLT
					release = CYP
					release = SUX
					release = LON
					release = NUT
					release = CRW
					release = MRC
					release = MNN
				}
				MRC = {
					annex_country = {
						target = ENG
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = tur_fragmentation_status
						option = tur_FRAGMENTED
					}
				}
				TUR = {
					release = IST
					release = AKD
					release = KUR
					release = ARM
					release = IZM
					release = AZD
					release = ANK
					release = KAR
				}
				ANK = {
					annex_country = {
						target = TUR
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = sov_fragmentation_status
						option = rus_FRAGMENTED
					}
				}
				SOV = {
					release = KAM
					release = YAK
					release = PRI
					release = SAK
					release = AMU
					release = OKH
					release = CTA
					release = ULA
					release = IRK
					release = KRA
					release = KMO
					release = NVO
					release = GNO
					release = TOM
					release = OMK
					release = TYU
					release = TOB
					release = SVE
					release = CYA
					release = NOV
					release = LPI
					release = MUS
					release = BLR
					release = UKR
					release = GEO
					release = ARM
					release = AZR
					release = KAZ
					release = UZB
					release = KYR
					release = TAJ
					release = TMS
					release = KZN
					release = CRI
					release = PRM
					release = DON
					release = KUB
					release = CHE
					release = MTN
					release = DAG
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = gre_fragmentation_status
						option = GRE_FRAGMENTED
					}
				}
				GRE = {
					release = ATH
					release = CRE
					release = THE
					release = THR
					release = PEL
					release = EPR
				}
				ATH = {
					annex_country = {
						target = GRE
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = kur_independence_status
						option = KUR_INDEPENDENT
					}
				}
				TUR = {
					release = KUR
				}
				IRQ = {
					release = KUR
				}
				PER = {
					release = KUR
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = czh_fragmentation_status
						option = czh_FRAGMENTED
					}
				}
				CZE = {
					release = SLO
					release = CRU
					release = MOV
					release = BOH
					release = GAL
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = chi_fragmentation_status
						option = chi_FRAGMENTED
					}
				}
				CHI = {
					release = HEI
					release = SHA
					release = QIN
					release = HEN
					release = JIA
					release = ANH
					release = NAN
					release = SHN
					release = ZHE
					release = FUJ
					release = JNG
					release = TIB
					release = HUB
					release = HNN
					release = GUI
					release = SCH
					release = TIA
					release = NGO
					release = XIA
					release = TAI
				}
				PRC = {
					transfer_state = 744
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = chi_fragmentation_status
						option = free_HGK
					}
				}
				CHI = {
					release = HEI
					release = SHA
					release = QIN
					release = HEN
					release = JIA
					release = ANH
					release = NAN
					release = SHN
					release = ZHE
					release = FUJ
					release = JNG
					release = TIB
					release = HUB
					release = HNN
					release = GUI
					release = SCH
					release = TIA
					release = NGO
					release = XIA
					release = TAI
				}
				PRC = {
					transfer_state = 744
				}
				ENG = {
					release = HGK
				}
				POR = {
					release = MCU
				}
				GXC = {
					transfer_state = 728
				}
				GXC = {
					release = HGK
					release = MCU
				}
				NAN = {
					annex_country = {
						target = CHI
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = yug_fragmentation_status
						option = YUG_FRAGMENTED
					}
				}
				YUG = {
					
					release = BNT
					release = KOS
					release = SLV
					release = BOS
					release = MAC
					release = SER
					release = CRO
					release = MNT
					
				}
				CRO = {
					transfer_state = 827
				}
				SER = {
					annex_country = {
						target = YUG
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = sov_fragmentation_status
						option = SOV_FRAGMENTED
					}
				}
				SOV = {
					release = UKR
					release = BLR
					release = GEO
					release = AZR
					release = ARM
					release = UZB
					release = TAJ
					release = KYR
					release = TMS
					release = KAZ
					retire_country_leader = yes
                    set_cosmetic_tag = SOV_russia
                    set_global_flag = SOV_became_russia
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = ita_fragmentation_status
						option = ITA_FRAGMENTED
					}
				}
				ITA = {
					release = VAT
					release = LOM
					release = TIR
					release = VNC
					release = SAV
					release = SAR
					release = NAP
					release = SIC
					release = TUS
					release = PAM
					release = LUC
					release = MOD
				}
				VNC = {
					annex_country = {
						target = ITA
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = raj_fragmentation_status
						option = RAJ_FRAGMENTED
					}
				}
				RAJ = {
					release = BAN
					release = PAK
					release = BRM
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = bel_fragmentation_status
						option = BEL_FRAGMENTED
					}
				}
				BEL = {
					release = WLL
					release = FLA
				}
				WLL = {
					annex_country = {
						target = BEL
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = hol_fragmentation_status
						option = HOL_FRAGMENTED
					}
				}
				HOL = {
					release = HLN
					release = BRB
					release = FRI
				}
				HLN = {
					annex_country = {
						target = HOL
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = rom_fragmentation_status
						option = ROM_FRAGMENTED
					}
				}
				ROM = {
					release = WAL
					release = MLA
					release = TRA
					release = BNT
				}
				WAL = {
					annex_country = {
						target = ROM
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = spr_fragmentation_status
						option = SPR_FRAGMENTED
					}
				}
				178 = { remove_core_of = SPR }
				118 = { remove_claim_by = SPR }
				SPR = {
					every_owned_state = {
						limit = {
							OR = {
								state = 165
								state = 171
								state = 792
							}
						}
						remove_dynamic_modifier = { modifier = autonomous_state }
					}
					release = VAL
					release = NAV
					release = CAS
					release = CAT
					release = LEO
					release = SEV
					release = GRA
					release = ZAR
					release = BAD
					release = TOL
				}
				ENG = {
					release = GRA
				}
				POR = {
					annex_country = {
						target = SPR
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = pol_fragmentation_status
						option = POL_FRAGMENTED
					}
				}
				POL = {
					release = POZ
					release = WAR
					release = GAL
					release = UKR
					release = BLR
					release = DNZ
					release = SIL
				}
				LIT = {
					annex_country = {
						target = POL
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = fra_fragmentation_status
						option = FRA_FRAGMENTED
					}
				}
				FRA = {
					release = ILE
					release = OCC
					release = BRI
					release = ANJ
					release = ALC
					release = AQU
					release = BER
					release = AUV
					release = SAV
					release = PIC
					release = NRM
					release = BRG
					release = COR
					release = FCM
					release = ORL
					release = POI
					release = PRO
					release = CHM
					release = DPH
				}
				ILE = {
					annex_country = {
						target = FRA
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = jap_fragmentation_status
						option = JAP_FRAGMENTED
					}
				}
				JAP = {
					release = RYU
					release = KYU
					release = HIR
					release = NAG
					release = TOK
					release = AOM
					release = MAN
					release = CHI
					release = SAK
					release = GUM
					release = FSM
					release = KOR
					release = KYO
				}
				TOK = {
					annex_country = {
						target = JAP
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = jap_fragmentation_status
						option = JAP_AND_TAI_FRAGMENTED
					}
				}
				JAP = {
					release = RYU
					release = KYU
					release = HIR
					release = NAG
					release = TOK
					release = AOM
					release = TAI
					release = MAN
					release = SAK
					release = GUM
					release = FSM
					release = KOR
					release = KYO
					release = CHI
				}
				TOK = {
					annex_country = {
						target = JAP
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = jap_fragmentation_status
						option = JAP_SENGOKU_JIDAI
					}
				}
				JAP = {
					release = RYU
					release = KYU
					release = HIR
					release = NAG
					release = TOK
					release = AOM
					release = TAI
					release = MAN
					release = SAK
					release = GUM
					release = FSM
					release = KOR
					release = KYO
					release = CHI
				}
				TOK = {
					annex_country = {
						target = JAP
					}
					puppet = KYU
					puppet = HIR
					puppet = KYO
					puppet = NAG
					puppet = AOM
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = ger_fragmentation_status
						option = GER_FRAGMENTED
					}
				}
				GER = {
					release = BRN
					release = POM
					release = HES
					release = PRE
					release = WUR
					release = BAY
					release = HAN
					release = RHE
					release = SAX
					release = SHL
					release = MEK
					release = SIL
				}
				42 = { set_demilitarized_zone = no }
				51 = { set_demilitarized_zone = no }
				822 = { set_demilitarized_zone = no }
				823 = { set_demilitarized_zone = no }
				PRE = {
					annex_country = {
						target = GER
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = usa_fragmentation_status
						option = USA_FRAGMENTED
					}
				}
				USA = {
					release = HAW
					release = ALA
					release = INA
					release = ILL
					release = WIS
					release = MIC
					release = IOW
					release = MIN
					release = SDA
					release = NDA
					release = MNA
					release = IDA
					release = WAS
					release = ORE
					release = NEB
					release = KAN
					release = CLR
					release = WYO
					release = UTA
					release = NEV
					release = CAL
					release = ARI
					release = NMX
					release = TEX
					release = OKL
					release = MSS
					release = ARK
					release = LOU
					release = MIS
					release = KEN
					release = TEN
					release = ALA
					release = FLO
					release = GUS
					release = SCA
					release = NCA
					release = VIR
					release = MRY
					release = PEN
					release = NJE
					release = NEW
					release = NEN
					release = OHI
					release = ALS
					release = KNT
					release = MAI
					release = MAS
					release = VMT
					release = CNE
					release = RHI
					release = NHM
					release = PUE
					release = WDC
					release = WVA
					release = DEL
				}
				HAW = {
					annex_country = {
						target = USA
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_south_america
						option = TRADER_SA
					}
				}
				BOL = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country {target = BRA transfer_troops = no}
					annex_country {target = PAR transfer_troops = no}
					annex_country {target = URG transfer_troops = no}
					annex_country {target = ARG transfer_troops = no}
					annex_country {target = PRU transfer_troops = no}
					annex_country {target = CHL transfer_troops = no}
					annex_country {target = ECU transfer_troops = no}
					annex_country {target = COL transfer_troops = no}
					annex_country {target = VEN transfer_troops = no}
					transfer_state = 310
					transfer_state = 309
					transfer_state = 687
					transfer_state = 270
					transfer_state = 299
					transfer_state = 720
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_central_america
						option = TRADER_CA_1
					}
				}
				PAN = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country {target = ELS transfer_troops = no}
					annex_country {target = NIC transfer_troops = no}
					annex_country {target = COS transfer_troops = no}
					annex_country {target = GUA transfer_troops = no}
					annex_country {target = HON transfer_troops = no}
					annex_country {target = CUB transfer_troops = no}
					annex_country {target = HAI transfer_troops = no}
					annex_country {target = DOM transfer_troops = no}
					transfer_state = 311
					transfer_state = 689
					transfer_state = 690
					transfer_state = 685
					transfer_state = 686
					transfer_state = 693
					transfer_state = 695
					transfer_state = 691
					transfer_state = 692
					transfer_state = 694
					transfer_state = 308
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_central_america
						option = TRADER_CA_2
					}
				}
				PAN = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country {target = ELS transfer_troops = no}
					annex_country {target = NIC transfer_troops = no}
					annex_country {target = COS transfer_troops = no}
					annex_country {target = GUA transfer_troops = no}
					annex_country {target = HON transfer_troops = no}
					transfer_state = 311
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_north_america
						option = TRADER_NA
					}
				}
				USA = {
					release = CAL
				}
				CAL = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country {target = USA transfer_troops = no}
					annex_country {target = CAN transfer_troops = no}
					annex_country {target = MEX transfer_troops = no}
					transfer_state = 331
					transfer_state = 332
					transfer_state = 730
					transfer_state = 696
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_africa
						option = TRADER_AF
					}
				}
				BEL = {
					release = RWA
				}
				RWA = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = ETH transfer_troops = no}
					annex_country = {target = LIB transfer_troops = no}
					transfer_state = 541
					transfer_state = 681
					transfer_state = 275
					transfer_state = 542
					transfer_state = 545
					transfer_state = 544
					transfer_state = 540
					transfer_state = 771
					transfer_state = 295
					transfer_state = 770
					transfer_state = 546
					transfer_state = 796
					transfer_state = 538
					transfer_state = 718
					transfer_state = 769
					transfer_state = 548
					transfer_state = 559
					transfer_state = 269
					transfer_state = 268
					transfer_state = 550
					transfer_state = 549
					transfer_state = 539
					transfer_state = 719
					transfer_state = 543
					transfer_state = 708
					transfer_state = 713
					transfer_state = 709
					transfer_state = 706 
					transfer_state = 707
					transfer_state = 547
					transfer_state = 297
					transfer_state = 773
					transfer_state = 660
					transfer_state = 767 
					transfer_state = 558
					transfer_state = 776
					transfer_state = 777
					transfer_state = 274
					transfer_state = 779
					transfer_state = 780
					transfer_state = 700
					transfer_state = 296
					transfer_state = 272
					transfer_state = 701
					transfer_state = 557
					transfer_state = 774
					transfer_state = 775
					transfer_state = 273
					transfer_state = 663
					transfer_state = 662
					transfer_state = 661
					transfer_state = 451
					transfer_state = 450
					transfer_state = 449 
					transfer_state = 448
					transfer_state = 665 
					transfer_state = 458
					transfer_state = 462
					transfer_state = 461
					transfer_state = 704
					transfer_state = 703
					transfer_state = 702
					transfer_state = 178
					transfer_state = 699 
					transfer_state = 772
					transfer_state = 551
					transfer_state = 782
					transfer_state = 786
					transfer_state = 778
					transfer_state = 781
					transfer_state = 556
					transfer_state = 515
					transfer_state = 514
					transfer_state = 513
					transfer_state = 459
					transfer_state = 513
					transfer_state = 460
					transfer_state = 290
					transfer_state = 783
					transfer_state = 705
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_africa
						option = TRADER_AF_2
					}
				}
				BEL = {
					release = RWA
				}
				RWA = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = ETH transfer_troops = no}
					annex_country = {target = LIB transfer_troops = no}
					transfer_state = 541
					transfer_state = 681
					transfer_state = 275
					transfer_state = 542
					transfer_state = 545
					transfer_state = 544
					transfer_state = 540
					transfer_state = 771
					transfer_state = 295
					transfer_state = 770
					transfer_state = 546
					transfer_state = 796
					transfer_state = 538
					transfer_state = 718
					transfer_state = 769
					transfer_state = 548
					transfer_state = 559
					transfer_state = 269
					transfer_state = 268
					transfer_state = 550
					transfer_state = 549
					transfer_state = 539
					transfer_state = 719
					transfer_state = 543
					transfer_state = 708
					transfer_state = 713
					transfer_state = 709
					transfer_state = 706 
					transfer_state = 707
					transfer_state = 547
					transfer_state = 297
					transfer_state = 773
					transfer_state = 660
					transfer_state = 767 
					transfer_state = 558
					transfer_state = 776
					transfer_state = 777
					transfer_state = 274
					transfer_state = 779
					transfer_state = 780
					transfer_state = 700
					transfer_state = 296
					transfer_state = 272
					transfer_state = 701
					transfer_state = 557
					transfer_state = 774
					transfer_state = 775
					transfer_state = 704
					transfer_state = 703
					transfer_state = 702
					transfer_state = 178
					transfer_state = 699 
					transfer_state = 772
					transfer_state = 551
					transfer_state = 782
					transfer_state = 786
					transfer_state = 778
					transfer_state = 781
					transfer_state = 556
					transfer_state = 515
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_middle_east
						option = TRADER_ME
					}
				}
				YEM = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = OMA transfer_troops = no}
					annex_country = {target = SAU transfer_troops = no}
					annex_country = {target = IRQ transfer_troops = no}
					annex_country = {target = PER transfer_troops = no}
					transfer_state = 659
					transfer_state = 658
					transfer_state = 765
					transfer_state = 656
					transfer_state = 455
					transfer_state = 454
					transfer_state = 453
					transfer_state = 447
					transfer_state = 446
					transfer_state = 452
					transfer_state = 552
					transfer_state = 456
					transfer_state = 457
					transfer_state = 816
					transfer_state = 553
					transfer_state = 677
					transfer_state = 554
					transfer_state = 680
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_europe
						option = TRADER_EU
					}
				}
				SWI = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = AUS transfer_troops = no}
					annex_country = {target = CZE transfer_troops = no}
					annex_country = {target = YUG transfer_troops = no}
					annex_country = {target = ALB transfer_troops = no}
					annex_country = {target = BUL transfer_troops = no}
					annex_country = {target = ROM transfer_troops = no}
					annex_country = {target = HUN transfer_troops = no}
					annex_country = {target = POL transfer_troops = no}
					annex_country = {target = GER transfer_troops = no}
					annex_country = {target = LUX transfer_troops = no}
					annex_country = {target = NOR transfer_troops = no}
					annex_country = {target = SWE transfer_troops = no}
					annex_country = {target = FIN transfer_troops = no}
					annex_country = {target = LIT transfer_troops = no}
					annex_country = {target = LAT transfer_troops = no}
					annex_country = {target = EST transfer_troops = no}
					annex_country = {target = GRE transfer_troops = no}
					annex_country = {target = TUR transfer_troops = no}
					annex_country = {target = IRE transfer_troops = no}
					annex_country = {target = DEN transfer_troops = no}
					transfer_state = 6
					transfer_state = 34
					transfer_state = 35
					transfer_state = 36
					transfer_state = 7
					transfer_state = 28
					transfer_state = 18
					transfer_state = 29
					transfer_state = 785
					transfer_state = 17 
					transfer_state = 15
					transfer_state = 16 
					transfer_state = 27 
					transfer_state = 24 
					transfer_state = 30 
					transfer_state = 14
					transfer_state = 23 
					transfer_state = 33
					transfer_state = 26
					transfer_state = 25
					transfer_state = 19 
					transfer_state = 31
					transfer_state = 22
					transfer_state = 20
					transfer_state = 21
					transfer_state = 32
					transfer_state = 735
					transfer_state = 1
					transfer_state = 130
					transfer_state = 132
					transfer_state = 122
					transfer_state = 128
					transfer_state = 129
					transfer_state = 125
					transfer_state = 126
					transfer_state = 127
					transfer_state = 338
					transfer_state = 123
					transfer_state = 131
					transfer_state = 121
					transfer_state = 133
					transfer_state = 120
					transfer_state = 119
					transfer_state = 165
					transfer_state = 794
					transfer_state = 166
					transfer_state = 167
					transfer_state = 177
					transfer_state = 168
					transfer_state = 793 
					transfer_state = 176
					transfer_state = 172 
					transfer_state = 792
					transfer_state = 790
					transfer_state = 171
					transfer_state = 174 
					transfer_state = 791
					transfer_state = 788
					transfer_state = 41
					transfer_state = 175 
					transfer_state = 170
					transfer_state = 789
					transfer_state = 169
					transfer_state = 173 
					transfer_state = 118
					transfer_state = 179 
					transfer_state = 795 
					transfer_state = 112
					transfer_state = 181
					transfer_state = 180
					transfer_state = 698
					transfer_state = 697
					transfer_state = 158 
					transfer_state = 159 
					transfer_state = 806 
					transfer_state = 39
					transfer_state = 160 
					transfer_state = 736
					transfer_state = 798
					transfer_state = 799
					transfer_state = 797
					transfer_state = 161
					transfer_state = 162
					transfer_state = 800
					transfer_state = 2
					transfer_state = 157
					transfer_state = 117
					transfer_state = 156
					transfer_state = 115
					transfer_state = 114
					transfer_state = 163
					transfer_state = 164
					transfer_state = 116
					transfer_state = 183
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_russia
						option = TRADER_RS
					}
				}
				SOV = {
					set_cosmetic_tag = trader
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation	
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_russia
						option = TRADER_RS_2
					}
				}
				SOV = {
					release = NVO
				}
				NVO = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					transfer_state = 644
					transfer_state = 562
					transfer_state = 637
					transfer_state = 560
					transfer_state = 657
					transfer_state = 409
					transfer_state = 408
					transfer_state = 561
					transfer_state = 563
					transfer_state = 565
					transfer_state = 574
					transfer_state = 575
					transfer_state = 516
					transfer_state = 576
					transfer_state = 564
					transfer_state = 566
					transfer_state = 567
					transfer_state = 568
					transfer_state = 569
					transfer_state = 654
					transfer_state = 40 
					transfer_state = 578
					transfer_state = 577
					transfer_state = 579
					transfer_state = 580
					transfer_state = 403
					transfer_state = 571
					transfer_state = 570
					transfer_state = 653
					transfer_state = 572
					transfer_state = 582
					transfer_state = 573
					transfer_state = 581
					transfer_state = 655
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_east_asia
						option = TRADER_EA_2
					}
				}
				BHU = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = AFG transfer_troops = no}
					annex_country = {target = RAJ transfer_troops = no}
					annex_country = {target = NEP transfer_troops = no}
					annex_country = {target = TIB transfer_troops = no}
					annex_country = {target = SIK transfer_troops = no}
					annex_country = {target = MON transfer_troops = no}
					annex_country = {target = TAN transfer_troops = no}
					annex_country = {target = XSM transfer_troops = no}
					annex_country = {target = CHI transfer_troops = no}
					annex_country = {target = YUN transfer_troops = no}
					annex_country = {target = PRC transfer_troops = no}
					annex_country = {target = SHX transfer_troops = no}
					annex_country = {target = MEN transfer_troops = no}
					annex_country = {target = MAN transfer_troops = no}
					annex_country = {target = GXC transfer_troops = no}
					annex_country = {target = SIA transfer_troops = no}
					transfer_state = 321
					transfer_state = 423
					transfer_state = 281
					transfer_state = 422
					transfer_state = 733
					transfer_state = 336
					transfer_state = 741
					transfer_state = 286
					transfer_state = 671
					transfer_state = 670
					transfer_state = 728
					transfer_state = 729
					transfer_state = 326
					transfer_state = 609 
					transfer_state = 745
					transfer_state = 525
					transfer_state = 527
					transfer_state = 537
					transfer_state = 710
					transfer_state = 320
					transfer_state = 710
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_east_asia
						option = TRADER_EA
					}
				}
				BHU = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country = {target = AFG transfer_troops = no}
					annex_country = {target = RAJ transfer_troops = no}
					annex_country = {target = NEP transfer_troops = no}
					annex_country = {target = TIB transfer_troops = no}
					annex_country = {target = SIK transfer_troops = no}
					annex_country = {target = MON transfer_troops = no}
					annex_country = {target = TAN transfer_troops = no}
					annex_country = {target = XSM transfer_troops = no}
					annex_country = {target = CHI transfer_troops = no}
					annex_country = {target = YUN transfer_troops = no}
					annex_country = {target = PRC transfer_troops = no}
					annex_country = {target = SHX transfer_troops = no}
					annex_country = {target = MEN transfer_troops = no}
					annex_country = {target = MAN transfer_troops = no}
					annex_country = {target = JAP transfer_troops = no}
					annex_country = {target = GXC transfer_troops = no}
					annex_country = {target = SIA transfer_troops = no}
					transfer_state = 321
					transfer_state = 423
					transfer_state = 281
					transfer_state = 422
					transfer_state = 733
					transfer_state = 336
					transfer_state = 741
					transfer_state = 286
					transfer_state = 671
					transfer_state = 670
					transfer_state = 728
					transfer_state = 729
					transfer_state = 326
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = trader_oceania
						option = TRADER_OC
					}
				}
				NZL = {
					add_ideas = super_disarmed_nation
					add_ideas = disorganized_government
					add_ideas = neutrality_idea
					add_ideas = free_trade
					add_ideas = disarmed_nation
					set_cosmetic_tag = trader
					annex_country {target = AST transfer_troops = no}
					annex_country {target = INS transfer_troops = no}
					annex_country {target = PHI transfer_troops = no}
					transfer_state = 712
					transfer_state = 711
					transfer_state = 333
					transfer_state = 721
					transfer_state = 635
					transfer_state = 734
					transfer_state = 636
					transfer_state = 643
					transfer_state = 639
					transfer_state = 725
					transfer_state = 641
				}
			}
		}
	}

	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			if = { # Reducing the Crisisjaren idea to level 1 when capitulated (in case player didn't manage to finish the mainland industrial focuses), but still needs Liberation to remove it fully
				limit = {
					original_tag = HOL
					has_idea = HOL_de_crisisjaren_4
				}
				swap_ideas = {
					remove_idea = HOL_de_crisisjaren_4
					add_idea = HOL_de_crisisjaren_1
				}
			}
			if = {
				limit = {
					original_tag = HOL
					has_idea = HOL_de_crisisjaren_3
				}
				swap_ideas = {
					remove_idea = HOL_de_crisisjaren_3
					add_idea = HOL_de_crisisjaren_1
				}
			}
			if = {
				limit = {
					original_tag = HOL
					has_idea = HOL_de_crisisjaren_2
				}
				swap_ideas = {
					remove_idea = HOL_de_crisisjaren_2
					add_idea = HOL_de_crisisjaren_1
				}
			}
			if = { # Only possible if Abandon the Gold Standard hasn't been taken yet, this can be taken later so should be reduced to level 2 rather than 1
				limit = {
					original_tag = HOL
					has_idea = HOL_de_crisisjaren_5
				}
				swap_ideas = {
					remove_idea = HOL_de_crisisjaren_5
					add_idea = HOL_de_crisisjaren_2
				}
			}
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = HOL
						has_completed_focus = HOL_wilhelminism
					}
				}
				HOL = { country_event = { id = mtg_netherlands.76 } }
			}
		}
	}

	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					original_tag = GER
					FROM = { original_tag = HOL }
				}
				remove_ideas = HOL_german_defectors_2
			}
			# USA 'civil war' ends
			if = {
				limit = {
					tag = CSA
					FROM = { original_tag = USA }
				}
				load_focus_tree = { tree = usa_focus keep_completed = no }
				unlock_national_focus = USA_reestablish_the_gold_standard
				complete_national_focus = USA_america_first
				unlock_national_focus = USA_ally_with_the_silver_shirts
				unlock_national_focus = USA_invite_foreign_support
			}
		}
	}

	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					original_tag = HOL
					has_completed_focus = HOL_wilhelminism
					FROM = {
						original_tag = GER
						has_government = fascism
						has_civil_war = no
					}
					FROM.FROM = {
						is_core_of = GER
					}
				}
				FROM.FROM = { 
					set_state_flag = HOL_german_states_kaiser
				}
				country_event = { id = mtg_netherlands.73 }
			}
			if = {
				limit = {
					FROM.FROM = {
						OR = {
							state = 7
							state = 35
							state = 36
						}
					}
				}
				FROM = {
					set_country_flag = HOL_lost_starting_state
				}
			}
		}
	}

	on_nuke_drop = {
		effect = {			
			if = {
				limit = {
					tag = USA
					FROM = {
						state = 16
					}
				}
				set_country_flag = achievement_team_america
			}
		}
	}

	# FROM is the sinker, ROOT is the owner of the ship being sunk
	on_pride_of_the_fleet_sunk = {
		effect = {
			if = {
				limit = {
					tag = ENG
				}
				FROM = { set_country_flag = achievements_pride_and_extreme_prejudice }
			}
		}
	}

	on_leave_faction = {
		effect = {
			if = {
				limit = { 
					original_tag = HOL
					has_country_flag = HOL_joined_germany_flag
				}
				FROM = {
					create_wargoal = {
						type = take_state_focus
						target = ROOT
						generator = { 7 }
					}
				}
			}
		}
	}

	# ROOT is the new faction leader FROM is the old faction leader
	on_assume_faction_leadership = {
		effect = {
			if = {
				limit = {
					FROM = {
						OR = {
							tag = GER
							tag = ENG
							tag = SOV
						}
					}
					NOT = {
						OR = {
							tag = USA
							tag = ENG
							tag = GER
							tag = ITA
							tag = FRA
							tag = SOV
							tag = JAP
							tag = CHI
						}
					}
				}
				set_country_flag = assuming_direct_control_achievement_flag
			}
		}
	}
	#ROOT is subject FROM is previous overlord
	on_subject_free = {
		effect = {
			if = {
				limit = { 
					has_country_flag = color_changd
				} 
				clr_country_flag = color_changd
				drop_cosmetic_tag = yes
			}
		}
	}
	on_subject_annexed = {
		effect = {
			if = {
				limit = { 
					has_country_flag = color_changd
				} 
				clr_country_flag = color_changd
				drop_cosmetic_tag = yes
			}
		}
	}
}
